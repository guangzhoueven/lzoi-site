#include <bits/stdc++.h>
using namespace std;
using i64 = long long;

i64 solve1(const string& s) {
	i64 len = s.size(), ans = -1;
	for (i64 i = 0; i < len; i++) {
		i64 r = i;
		while (i + 1 < len && s[r] == s[i + 1]) i++;
		ans = max(ans, i - r + 1);
	}
	return ans;
}
i64 solve2(const string& s, char a, char b) {
	i64 len = s.size(), ans = 0, cnt = 0;
	unordered_map<i64, i64> m;
	m[0] = -1;
	for (i64 i = 0; i < len; i++) {
		if (s[i] == a) cnt++;
		else if (s[i] == b) cnt--;
		else {
			cnt = 0;
			m.clear();
			m[0] = i;
		}
		if (m.count(cnt)) ans = max(ans, i - m[cnt]);
		else m[cnt] = i;
	}
	return ans;
}
i64 solve3(const string& s, char a, char b, char c) {
	i64 len = s.size(), ans = 0;
	i64 x = 0, y = 0;
	map<pair<i64, i64>, i64> m;
	m[ {0, 0} ] = -1;
	for (i64 i = 0; i < len; i++) {
		if (s[i] == a) x++;
		else if (s[i] == b) x--, y++;
		else y--;
		if (m.count({x, y})) ans = max(ans, i - m[ {x, y} ]);
		else m[ {x, y} ] = i;
	}
	return ans;
}
i64 solve(const string& s) {
	i64 ans    = solve1(s);
	i64 resab  = solve2(s, 'a', 'b');
	i64 resac  = solve2(s, 'a', 'c');
	i64 resbc  = solve2(s, 'b', 'c');
	i64 resabc = solve3(s, 'a', 'b', 'c');
	return max({ans, resab, resac, resbc, resabc});
}

int main() {
	ios::sync_with_stdio(false), cin.tie(nullptr), cout.tie(nullptr);
	i64 T;
	cin >> T;
	while (T--) {
		string s;
		cin >> s;
		cout << solve(s) << "\n";
	}
	return 0;
}
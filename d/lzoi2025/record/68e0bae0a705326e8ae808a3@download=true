#include <bits/stdc++.h>
using namespace std;
using i64 = long long;

int main() {
	ios::sync_with_stdio(false), cin.tie(nullptr), cout.tie(nullptr);
	i64 n, m;
	cin >> n >> m;
	
	vector<vector<i64>> grid(n, vector<i64>(m));
	for (i64 i = 0; i < n; i++) 
		for (i64 j = 0; j < m; j++) cin >> grid[i][j];
	
	vector<vector<i64>> dp(n, vector<i64>(m, -1));
	vector<i64> dx = {-1, 0, 1, 0};
	vector<i64> dy = {0, 1, 0, -1};
	
	auto dfs = [&](auto&& self, i64 x, i64 y) -> i64 {
		if (dp[x][y] != -1) return dp[x][y];
		dp[x][y] = 1;  // 至少包含当前点
		for (i64 i = 0; i < 4; i++) {
			i64 nx = x + dx[i];
			i64 ny = y + dy[i];    
			if (nx >= 0 && nx < n && ny >= 0 && ny < m && grid[nx][ny] < grid[x][y]) 
				dp[x][y] = max(dp[x][y], self(self, nx, ny) + 1);
		}
		return dp[x][y];
	};
	
	i64 ans = 0;
	for (i64 i = 0; i < n; i++) 
		for (i64 j = 0; j < m; j++) 
			ans = max(ans, dfs(dfs, i, j));
	
	cout << ans << "\n";
	return 0;
}
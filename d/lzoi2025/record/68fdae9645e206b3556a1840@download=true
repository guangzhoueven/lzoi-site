#include <bits/stdc++.h>
using namespace std;
using i64 = long long;

int main() {
	ios::sync_with_stdio(false), cin.tie(nullptr), cout.tie(nullptr);
	i64 T;
	cin >> T;
	auto ok = [&](const vector<vector<i64>>& g, i64 n, i64 m) -> i64 {
		map<pair<i64, i64>, i64 > mp;
		auto dfs = [&](auto&& self, i64 row, i64 prev) -> i64 {
			if (row == n) return 0;

			auto key = make_pair(row, prev);
			if (auto it = mp.find(key); it != mp.end()) return it->second;

			i64 tmp = 0, state = 1 << m;
			for (i64 mask = 0; mask < state; mask++) {
				if (mask & (mask >> 1)) continue;
				if (prev & (mask | (mask >> 1) | (mask << 1))) continue;

				i64 sum = 0;
				for (i64 j = 0; j < m; j++)
					if (mask >> j & 1) sum += g[row][j];

				tmp = max(tmp, sum + self(self, row + 1, mask));
			}
			return mp[key] = tmp;
		};
		return dfs(dfs, 0, 0);
	};

	while (T--) {
		i64 n, m;
		cin >> n >> m;
		vector<vector<i64>> g(n, vector<i64>(m));
		for (auto& num : g)	for (auto& x : num)	cin >> x;
		cout << ok(g, n, m) << "\n";
	}
	return 0;
}
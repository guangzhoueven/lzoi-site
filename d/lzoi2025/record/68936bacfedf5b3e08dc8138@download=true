#include <bits/stdc++.h>
using namespace std;
// 用deque会出现一个测试点 #4-19 会MLE，所以用了list优化
void calc(map<int, list<int>>& q, const string& op, int a, int x = 0) {
	if (op == "push_back") 						 q[a].push_back(x);
	else if (op == "pop_back" && !q[a].empty())  q[a].pop_back();
	else if (op == "push_front") 				 q[a].push_front(x);
	else if (op == "pop_front" && !q[a].empty()) q[a].pop_front();
	else if (op == "size") 						 cout << q[a].size() << "\n";
	else if (op == "front" && !q[a].empty()) 	 cout << q[a].front() << "\n";
	else if (op == "back" && !q[a].empty()) 	 cout << q[a].back() << "\n";
}

int main() {
	ios::sync_with_stdio(false), cin.tie(nullptr), cout.tie(nullptr);
	int T;
	cin >> T;
	map<int, list<int>> q;
	while (T--) {
		string op;
		cin >> op;
		int a, x = 0;
		if (op == "push_back" || op == "push_front") cin >> a >> x;
		else cin >> a;
		calc(q, op, a, x);
	}
	return 0;
}